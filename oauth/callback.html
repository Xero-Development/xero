<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>PX-OS | OAuth Callback</title>
<link rel="stylesheet" href="../x-layout.css"/><link rel="stylesheet" href="../x-components.css"/><link rel="stylesheet" href="../x-forms.css"/><link rel="stylesheet" href="../x-icons.css"/><link rel="stylesheet" href="../x-animations.css"/><link rel="stylesheet" href="../x-styles.css"/>
<style>.x-page{max-width:720px;margin:0 auto;padding:22px}</style></head>
<body class="x-app"><main class="x-page"><section class="x-card"><h1>Signing you in…</h1><p class="x-muted" id="status">Finishing OAuth callback.</p></section></main>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="../supabase-client.js"></script>
<script>
(async () => {
  const statusEl = document.getElementById("status");

  const qs = new URLSearchParams(location.search);
  const code = qs.get("code");
  const err = qs.get("error") || qs.get("error_code");
  const errDesc = qs.get("error_description");

  try {
    if (err) throw new Error(errDesc ? decodeURIComponent(errDesc) : err);

    if (code) {
      const { error } = await window.sb.auth.exchangeCodeForSession(code);
      if (error) throw error;
    } else {
      // detectSessionInUrl=true will pick up hash fragments if present
      await window.sb.auth.getSession();
    }

    statusEl.textContent = "Done. Redirecting…";
    location.replace(new URL("../dashboard.html", location.href).toString());
  } catch (e) {
    statusEl.textContent = "OAuth callback failed: " + (e?.message || String(e));
  }
})();
</script>
</body></html>
